<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="小禹君">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://QWEpure.github.io/2024/04/29/数据分析/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="[TOC] pandans导入excel文件Excel文件的格式为xls和xlsx，pandas读取excel文件需要安装依赖库xlrd和openpyxl。  !注意：当xlrd&gt;&#x3D;2.0时，只支持xls格式，不再支持xlsx。   python3.9 win10 64bit pandas&#x3D;&#x3D;1.2.1 xlrd&#x3D;&#x3D;2.0.1 openpy">
<meta property="og:type" content="article">
<meta property="og:title" content="python数据分析">
<meta property="og:url" content="http://qwepure.github.io/2024/04/29/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="[TOC] pandans导入excel文件Excel文件的格式为xls和xlsx，pandas读取excel文件需要安装依赖库xlrd和openpyxl。  !注意：当xlrd&gt;&#x3D;2.0时，只支持xls格式，不再支持xlsx。   python3.9 win10 64bit pandas&#x3D;&#x3D;1.2.1 xlrd&#x3D;&#x3D;2.0.1 openpy">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191549261.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191550875.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191551975.png">
<meta property="og:image" content="https://assets.qingjiaoclass.com/qingjiao-ppt/2020-9-14/e916a242bd94afa2#business_type=upload_markdown">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191537526.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191537798.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191538529.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191539872.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191541468.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191542519.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191542400.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191543253.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191544588.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191544142.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191545281.png">
<meta property="og:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191546212.png">
<meta property="article:published_time" content="2024-04-29T14:38:19.536Z">
<meta property="article:modified_time" content="2024-05-27T10:02:02.236Z">
<meta property="article:author" content="小禹君">
<meta property="article:tag" content="数据分析">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191549261.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/OIP-C.png" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/OIP-C.png">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/OIP-C.png">
    <!--- Page Info-->
    
    <title>
        
            python数据分析 -
        
        Myblog
    </title>
    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">

    <!--- Font Part-->
    
    
    
    

    <!--- Inject Part-->
    
    <script id="hexo-configurations">
    window.config = {"hostname":"qwepure.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":true,"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/background1.webp","dark":"/images/background2.webp"},"title":"/ᐠ - ˕ -マ Ⳋ","subtitle":{"text":["All you need just One More Try"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":"ture","links":{"zhihu":"https://www.zhihu.com/people/32-12-13-6# your ZhiHu URL","github":"https://github.com/QWEpure# your GitHub URL","instagram":null,"bilibili":"https://space.bilibili.com/372259848","email":"145780475@qq.com# your email"},"qrs":{"weixin":"https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202310171226598.jpg"}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":true,"type":"fixed","audios":[{"name":"Connected Sky","artist":"Blue Archive# audio artist","url":"https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202310171229490.MP3# audio url","cover":"https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202310171228460.png# audio cover url"}]},"mermaid":{"enable":false,"version":"9.3.0"}},"version":"2.5.0","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":70},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}},"search":{"enable":"ture","preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"info","announcement":"施工博客中","links":{"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Tags":{"path":"/tags","icon":"fa-regular fa-tags"},"Categories":{"path":"/categories","icon":"fa-regular fa-folder"}}},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2023/3/18 12:00:00"};
    window.lang_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
        <span class="swup-progress-icon">
            <i class="fa-solid fa-circle-notch fa-spin"></i>
        </span>
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container">
    
    <div class="navbar-content">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="/images/OIP-C.png">
                </a>
            
            <a class="logo-title" href="/">
                
                Myblog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/"  >
                                    
                                        
                                            <i class="fa-regular fa-house"></i>
                                        
                                        首页
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/archives"  >
                                    
                                        
                                            <i class="fa-regular fa-archive"></i>
                                        
                                        归档
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/tags"  >
                                    
                                        
                                            <i class="fa-regular fa-tags"></i>
                                        
                                        标签
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="" 
                                    href="/categories"  >
                                    
                                        
                                            <i class="fa-regular fa-folder"></i>
                                        
                                        分类
                                    
                                </a>
                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile drawer -->
    <div class="navbar-drawer w-full absolute top-0 left-0 bg-background-color">
        <ul class="drawer-navbar-list flex flex-col justify-start items-center">
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/"  >
                             
                                
                                    <i class="fa-regular fa-house"></i>
                                
                                首页
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/archives"  >
                             
                                
                                    <i class="fa-regular fa-archive"></i>
                                
                                归档
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/tags"  >
                             
                                
                                    <i class="fa-regular fa-tags"></i>
                                
                                标签
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            
                
                    <li class="drawer-navbar-item text-base my-1.5 flex justify-center items-center">
                        <a class="rounded-3xl py-1.5 px-5 hover:border hover:!text-primary active:!text-primary group " 
                        href="/categories"  >
                             
                                
                                    <i class="fa-regular fa-folder"></i>
                                
                                分类
                            
                        </a>
                    </li>
                    <!-- Submenu -->
                    
            

        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container">
    <div class="article-content-container">

        <div class="article-title">
            
                <h1 class="article-title-regular">python数据分析</h1>
            
            </div>
            
                    
        
        
            <div class="article-header flex flex-row gap-2 items-center">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/head2.png">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">小禹君</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-04-29 22:38:19</span>
        <span class="mobile">2024-04-29 22:38:19</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-05-27 18:02:02</span>
            <span class="mobile">2024-05-27 18:02:02</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/python/">python</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>8.6k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>37 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body">
            <hr>
<p>[TOC]</p>
<h1 id="pandans"><a href="#pandans" class="headerlink" title="pandans"></a>pandans</h1><h3 id="导入excel文件"><a href="#导入excel文件" class="headerlink" title="导入excel文件"></a>导入excel文件</h3><p>Excel文件的格式为<code>xls</code>和<code>xlsx</code>，pandas读取excel文件需要安装依赖库<code>xlrd</code>和<code>openpyxl</code>。</p>
<blockquote>
<p>!注意：当xlrd&gt;&#x3D;2.0时，只支持xls格式，不再支持xlsx。</p>
</blockquote>
<ul>
<li>python3.9</li>
<li>win10 64bit</li>
<li>pandas&#x3D;&#x3D;1.2.1</li>
<li>xlrd&#x3D;&#x3D;2.0.1</li>
<li>openpyxl&#x3D;&#x3D;3.0.7</li>
</ul>
<h5 id="读取工作表的内容"><a href="#读取工作表的内容" class="headerlink" title="读取工作表的内容"></a>读取工作表的内容</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span>)  <span class="comment"># 读取Excel文件</span></span><br><span class="line"><span class="built_in">print</span>(df)   <span class="comment"># 显示所有数据</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><strong>（1）解决列名不对齐</strong></p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;/home/qingjiao/Document/data/7_1/student.xlsx&#x27;</span>)  <span class="comment"># 读取Excel文件</span></span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 显示所有数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h6 id="（2）行列显示不全"><a href="#（2）行列显示不全" class="headerlink" title="（2）行列显示不全"></a>（2）行列显示不全</h6><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pd.set_option(<span class="string">&#x27;display.max_rows&#x27;</span>, <span class="number">1000</span>)  <span class="comment"># 最多显示1000行</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="number">1000</span>)  <span class="comment"># 最多显示1000列</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h5 id="通过二维数组创建-DataFrame-对象"><a href="#通过二维数组创建-DataFrame-对象" class="headerlink" title="通过二维数组创建 DataFrame 对象"></a>通过二维数组创建 DataFrame 对象</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">score = [[<span class="number">110</span>, <span class="number">105</span>, <span class="number">99</span>], [<span class="number">105</span>, <span class="number">88</span>, <span class="number">115</span>], [<span class="number">109</span>, <span class="number">120</span>, <span class="number">130</span>]]  <span class="comment"># 创建二维数组</span></span><br><span class="line"></span><br><span class="line">column_name = [<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]  <span class="comment"># 设置列索引</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data=score, columns=column_name)  <span class="comment"># 创建DataFrame对象</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h5 id="通过字典创建-DataFrame-对象"><a href="#通过字典创建-DataFrame-对象" class="headerlink" title="通过字典创建 DataFrame 对象"></a>通过字典创建 DataFrame 对象</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建字典对象</span></span><br><span class="line">score = &#123;<span class="string">&#x27;学生姓名&#x27;</span>: [<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;angel&#x27;</span>], <span class="string">&#x27;班级&#x27;</span>: <span class="string">&#x27;高三（3）班&#x27;</span>,</span><br><span class="line">         <span class="string">&#x27;语文&#x27;</span>: [<span class="number">110</span>, <span class="number">105</span>, <span class="number">99</span>], <span class="string">&#x27;数学&#x27;</span>: [<span class="number">105</span>, <span class="number">88</span>, <span class="number">115</span>], <span class="string">&#x27;英语&#x27;</span>: [<span class="number">109</span>, <span class="number">120</span>, <span class="number">130</span>]&#125;</span><br><span class="line"></span><br><span class="line">index_name = [<span class="string">&#x27;1001&#x27;</span>, <span class="string">&#x27;1002&#x27;</span>, <span class="string">&#x27;1003&#x27;</span>]  <span class="comment"># 设置行索引</span></span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data=score, index=index_name)  <span class="comment"># 创建DataFrame对象</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>



<h5 id="读取指定工作表的部分内容"><a href="#读取指定工作表的部分内容" class="headerlink" title="读取指定工作表的部分内容"></a>读取指定工作表的部分内容</h5><h6 id="行操作"><a href="#行操作" class="headerlink" title="行操作"></a>行操作</h6><p><code>skiprows</code>:为从头开始跳过的行数（<strong>包括属性名</strong>）</p>
<p><code>nrows</code>:为不超过几行</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取指定工作表的部分内容</span></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, skiprows=<span class="number">0</span>, nrows=<span class="number">10</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>读取前几行（<strong>不包括属性名</strong>）</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 导入Excel文件</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;/home/qingjiao/Document/data/8_1/movies.xlsx&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(df.head(<span class="number">3</span>))  <span class="comment"># 读取前3条数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>列操作</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取指定工作表的指定列</span></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, usecols=<span class="string">&#x27;A:C&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p><code>usecols</code>:以[num1,num2]的形式来指定列，’A:C‘来指定列范围</p>
<h6 id="读取指定工作表的指定列，并指定列名"><a href="#读取指定工作表的指定列，并指定列名" class="headerlink" title="读取指定工作表的指定列，并指定列名"></a>读取指定工作表的指定列，并指定列名</h6><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, usecols=<span class="string">&#x27;A:D&#x27;</span>, names=[<span class="string">&#x27;区队&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>,<span class="string">&#x27;姓名&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p><code>index_col</code>：以第几列为索引（默认是-1）</p>
<p><code>sheet_name</code>：选择表</p>
<p><code>heade</code>:以第几行为索引（默认是0）</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"><span class="comment">#r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">df = pd.read_excel(<span class="string">r&#x27;D:\桌面\工作簿1.xlsx&#x27;</span>,sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>,index_col=<span class="number">0</span>，header=<span class="number">0</span>)  <span class="comment"># 导入指定Sheet页的数据</span></span><br><span class="line"><span class="built_in">print</span>(df.head(<span class="number">3</span>))  <span class="comment"># 读取前3条数据</span></span><br></pre></td></tr></table></figure></div>



<h5 id="读取具有日期列的Excel文件"><a href="#读取具有日期列的Excel文件" class="headerlink" title="读取具有日期列的Excel文件"></a>读取具有日期列的Excel文件</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义日期解析器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dateparse</span>(<span class="params">date</span>):</span><br><span class="line">    <span class="keyword">return</span> pd.to_datetime(date)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取具有日期列的Excel文件</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;file.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>, parse_dates=[<span class="string">&#x27;Date&#x27;</span>], date_parser=dateparse)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择日期大于等于2022-01-01的数据</span></span><br><span class="line">df_filtered = df[df[<span class="string">&#x27;Date&#x27;</span>] &gt;= <span class="string">&#x27;2022-01-01&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p>在上述代码中，我们首先定义了一个名为dateparse的函数，将日期字符串解析为Pandas的日期类型。然后，我们使用parse_dates参数指定要解析的日期列为Date列，并使用date_parser参数传递dateparse函数。最后，我们选择日期大于等于2022-01-01的数据，存储在df_filtered变量中。</p>
<h5 id="读取多个工作表的内容"><a href="#读取多个工作表的内容" class="headerlink" title="读取多个工作表的内容"></a>读取多个工作表的内容</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取多个工作表的内容</span></span><br><span class="line">df1 = pd.read_excel(<span class="string">&#x27;file.xlsx&#x27;</span>, sheet_name=[<span class="string">&#x27;Sheet1&#x27;</span>, <span class="string">&#x27;Sheet2&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印工作表Sheet1的内容</span></span><br><span class="line"><span class="built_in">print</span>(df1[<span class="string">&#x27;Sheet1&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印工作表Sheet2的内容</span></span><br><span class="line"><span class="built_in">print</span>(df1[<span class="string">&#x27;Sheet2&#x27;</span>])</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h5 id="将Excel文件内容写入新的Excel文件"><a href="#将Excel文件内容写入新的Excel文件" class="headerlink" title="将Excel文件内容写入新的Excel文件"></a>将Excel文件内容写入新的Excel文件</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取Excel文件内容</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;file.xlsx&#x27;</span>, sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据进行处理</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将处理后的数据写入新的Excel文件</span></span><br><span class="line">df.to_excel(<span class="string">&#x27;new_file.xlsx&#x27;</span>, index=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><code>index=False</code>参数用于禁止将索引列写入Excel文件中。</p>
<h3 id="将数据导出为-Excel-文件"><a href="#将数据导出为-Excel-文件" class="headerlink" title="将数据导出为 Excel 文件"></a>将数据导出为 Excel 文件</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;编号&#x27;</span>: [<span class="string">&#x27;mr001&#x27;</span>, <span class="string">&#x27;mr002&#x27;</span>, <span class="string">&#x27;mr003&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;语文&#x27;</span>: [<span class="number">110</span>, <span class="number">105</span>, <span class="number">109</span>],</span><br><span class="line">    <span class="string">&#x27;数学&#x27;</span>: [<span class="number">105</span>, <span class="number">88</span>, <span class="number">120</span>],</span><br><span class="line">    <span class="string">&#x27;英语&#x27;</span>: [<span class="number">99</span>, <span class="number">115</span>, <span class="number">130</span>]&#125;)  <span class="comment"># 通过字典创建DataFrame对象</span></span><br><span class="line">    </span><br><span class="line">df.to_excel(<span class="string">&#x27;/home/qingjiao/score.xlsx&#x27;</span>,sheet_name=<span class="string">&#x27;1班&#x27;</span>)  <span class="comment"># 将数据导出为Excel文件</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="导入csv文件"><a href="#导入csv文件" class="headerlink" title="导入csv文件"></a>导入csv文件</h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入csv文件，并指定编码格式</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;/home/qingjiao/Document/data/8_2/student.csv&#x27;</span>,</span><br><span class="line">                 encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head())  <span class="comment"># 输出前5条数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191549261.png"
                      alt="image-20240519154938697"
                ></p>
<h3 id="将数据导出为-csv-文件"><a href="#将数据导出为-csv-文件" class="headerlink" title="将数据导出为 csv 文件"></a>将数据导出为 csv 文件</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;编号&#x27;</span>: [<span class="string">&#x27;mr001&#x27;</span>, <span class="string">&#x27;mr002&#x27;</span>, <span class="string">&#x27;mr003&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;语文&#x27;</span>: [<span class="number">110</span>, <span class="number">105</span>, <span class="number">109</span>],</span><br><span class="line">    <span class="string">&#x27;数学&#x27;</span>: [<span class="number">105</span>, <span class="number">88</span>, <span class="number">120</span>],</span><br><span class="line">    <span class="string">&#x27;英语&#x27;</span>: [<span class="number">99</span>, <span class="number">115</span>, <span class="number">130</span>]&#125;)  <span class="comment"># 通过字典创建DataFrame对象</span></span><br><span class="line"><span class="comment"># 保存&#x27;编号&#x27;和&#x27;语文&#x27;列，不保留行索引，设置分隔符为冒号&#x27;:&#x27;</span></span><br><span class="line">df.to_csv(<span class="string">&#x27;/home/qingjiao/score1.csv&#x27;</span>, sep=<span class="string">&#x27;:&#x27;</span>, columns=[<span class="string">&#x27;编号&#x27;</span>, <span class="string">&#x27;语文&#x27;</span>], </span><br><span class="line">          index=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>



<h2 id="导入-txt-文本文件"><a href="#导入-txt-文本文件" class="headerlink" title="导入 txt 文本文件"></a>导入 txt 文本文件</h2><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd </span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入txt文件，并指定分隔符和编码格式</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;/home/qingjiao/Document/data/8_2/student.txt&#x27;</span>, sep=<span class="string">&#x27;\t&#x27;</span>, encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df.head())  <span class="comment"># 输出前5条数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h5 id="导入指定列的数据"><a href="#导入指定列的数据" class="headerlink" title="导入指定列的数据"></a>导入指定列的数据</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入txt文件指定列数据，并指定分隔符和编码格式</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;/home/qingjiao/Document/data/8_2/student.txt&#x27;</span>,</span><br><span class="line">                 sep=<span class="string">&#x27;\t&#x27;</span>, usecols=[<span class="string">&#x27;学号&#x27;</span>, <span class="string">&#x27;姓名&#x27;</span>], encoding=<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 输出所有数据</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></div>

<h2 id="数据清洗"><a href="#数据清洗" class="headerlink" title="数据清洗"></a>数据清洗</h2><h4 id="重复值检测与处理"><a href="#重复值检测与处理" class="headerlink" title="重复值检测与处理"></a>重复值检测与处理</h4><h6 id="1-记录重复"><a href="#1-记录重复" class="headerlink" title="1.记录重复"></a>1.记录重复</h6><p><strong><code>duplicated</code><strong>函数用于</strong>标记</strong> <strong>Series</strong> 中的值、<strong>DataFrame</strong> 中的<strong>记录行</strong>是否重复</p>
<p>重复为 True，不重复为 False。该函数语法格式如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame.duplicated(subset=<span class="literal">None</span>,keep=<span class="string">&#x27;first&#x27;</span>)</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">pandas.Series.duplicated(keep=<span class="string">&#x27;first&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p>参数说明：</p>
<ul>
<li><p><code>subset</code>：用于识别重复的列标签或列标签序列，默认情况下使用<strong>所有列</strong>，默认值为 None。</p>
</li>
<li><p><code>keep</code>：处理删除重复项的方法。可以是**’first’、’last’ 或 False**，默认为 ‘first’。</p>
<p><code>first</code>：表示除了第一次出现外，其余相同的重复项标记为 True；</p>
<p><code>last</code>：表示<strong>除了最后一次</strong>出现外，其余相同的重复项标记为 True；</p>
<p><code>False</code>：表示将所有重复项标记为True。</p>
</li>
</ul>
<h6 id="2-处理重复"><a href="#2-处理重复" class="headerlink" title="2.处理重复"></a>2.处理重复</h6><p><code>drop_duplicates</code> 函数用于<strong>删除</strong> <strong>Series、DataFrame</strong> 中<strong>重复记录</strong>，<strong>并返回删除重复后的结果</strong>。该函数语法格式如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame.drop_duplicates(subset=<span class="literal">None</span>, keep=<span class="string">&#x27;first&#x27;</span>,</span><br><span class="line">				 inplace=<span class="literal">False</span>, ignore_index=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">pandas.Series.drop_duplicates(keep=<span class="string">&#x27;first&#x27;</span>, inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>

<p>参数说明：</p>
<ul>
<li><strong><code>inplace</code><strong>：指定</strong>是否返回</strong>新的 DataFrame 或 Series。bool 型，默认为 False。如果为 True，则在原对象上修改。</li>
<li>**<code>ignore_index</code>**：是否重新设置行索引。bool型，默认为False，如果为 True 时将在数据合并后，按照0，1，2，3….的顺序重新设置行索引，忽略了旧索引。</li>
</ul>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191550875.png"
                      alt="image-20240519155048965"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191551975.png"
                      alt="image-20240519155109730"
                ></p>
<h4 id="1-删除法"><a href="#1-删除法" class="headerlink" title="1.删除法"></a>1.删除法</h4><p>　　<strong>删除法是指将含有缺失值的特征或者记录删除</strong>。删除法分为<strong>删除观测记录和删除特征</strong>俩种，它属于通过减少样本量来换取信息完整度的一种方法，是一种最为简单的缺失值处理方法。pandas中提供了简便的删除缺失值的方法dropna，通过参数控制，该方法既可以删除观测记录，也可以删除特征。该方法的基本语法如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame.dropna(self, axis=<span class="number">0</span>, how=<span class="string">&#x27;any&#x27;</span>, thresh=<span class="literal">None</span>, subset=<span class="literal">None</span>, inplace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>

<p>　　具体参数及其说明如下所示：</p>
<table>
<thead>
<tr>
<th>参数说明</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>axis</td>
<td>接受0或1。表示轴向，0为删除观测记录（行），1为删除特征（列）。默认为0</td>
</tr>
<tr>
<td>how</td>
<td>接受特定string。表示删除的形式。取值为“any”时表示只要有缺失值存在就执行删除操作；取值为“all”时表示当且仅当全部为缺失值时才执行删除操作。默认为“any”</td>
</tr>
<tr>
<td>thresh</td>
<td>一行或一列中至少出现了 thresh 个才删除</td>
</tr>
<tr>
<td>subset</td>
<td>接收array。表示进行去重的列&#x2F;行。默认为None，表示所有列&#x2F;行</td>
</tr>
<tr>
<td>inplace</td>
<td>接收boolean。表示是否在原表上进行操作。默认为False</td>
</tr>
</tbody></table>
<h4 id="异常值检测"><a href="#异常值检测" class="headerlink" title="异常值检测"></a>异常值检测</h4><p>　　在数据分析中，除了常见的重复值和缺失值外，还会遇到一类非正常的数据，即异常值。</p>
<p>　　所谓异常值，就是指超出或低于正常范围的值，又称 <strong>离群点</strong> 。例如，年龄为负数、身高大于3米、成绩小于零，商品评分超出 5 分或商品日销售量远远超过年销售量等，都属于异常值。</p>
<p>　　从集合角度来看，异常值即离群点。因此，为了处理异常值，<strong>首先是判别数据集中是否存在离群点，然后再对离群点的数据进行处理</strong>。</p>
<p>判别数据集中异常值的方法主要有三种：<br>方式一：根据给定的数据范围进行判断，不在范围内的数据视为异常值。</p>
<p>方法二：3σ 原则<br>3σ 原则是指当数据服从<strong>正态分布</strong>时，根据正态分布的定义可知，距离平均值 3σ 之外的概率为<code>P(|X-μ|&gt;3σ)≤0.003</code>（σ代表标准差，μ代表均值，，X&#x3D;μ即为图像的对称轴），这属于极小概率事件，在默认情况下，可以认定距离超过平均值 3σ 的样本是不存在的。因此，当样本距离平均值大于 3σ 时，则认定该样本为异常值。<br>方法三：箱型图</p>
<p><strong>箱型图是显示一组数据分散情况资料的统计图。</strong> 它可以将数据通过<strong>四分位数</strong>的形式进行图形化描述，箱型图通过上限和下限作为数据分布的边界。箱线图提供了识别异常值的一个标准，即异常值通常被定义为小于QL-1.5IQR或者大于QU+1.5IQR的值。其中，QL称为下四分位数，QU称为上四分位数，IQR称为四分位数间距。如下图所示：</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://assets.qingjiaoclass.com/qingjiao-ppt/2020-9-14/e916a242bd94afa2#business_type=upload_markdown"
                      alt="img"
                ></p>
<h5 id="异常值处理"><a href="#异常值处理" class="headerlink" title="异常值处理"></a>异常值处理</h5><p>了解了异常值的检测后，接下来介绍如何处理异常值，主要包括以下几种处理方式：<br>（1）删除含有异常值的记录；<br>（2）将异常值视为缺失值，按照缺失值的处理方法来处理；<br>（3）用平均值来修正异常值；<br>（4）将异常值当特殊情况进行分析，研究异常值出现的原因；<br>（5）对异常值不处理。<br>DataFrame 对象中的 <strong>describe 函数</strong>可以生成描述性统计信息。语法结构如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DataFrame.describe(percentiles=<span class="literal">None</span>, include=<span class="literal">None</span>,</span><br><span class="line">exclude=<span class="literal">None</span>, datetime_is_numeric=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>

<p><strong>参数说明：</strong></p>
<ul>
<li><p><strong>percentiles</strong>：<strong>表示要包含在输出中的百分比</strong>，默认是[.25, .5, .75]，也就是返回25%，50%，75%数据量时的数字。</p>
</li>
<li><p><strong>include</strong>：</p>
<p>表示输出结果中都包含哪些内容</p>
<p>。自动计算的字段有：count（非空值数）、unique（唯一值数）、top（频数最高者）、freq（最高频数）、mean（平均值）、std（方差）、min（最小值）、50%（中位数）、max（最大值）等。</p>
<ul>
<li><strong>all</strong>：表示包含所有列；</li>
</ul>
</li>
<li><p><strong>None（默认）</strong>：所有数值型的列；</p>
<ul>
<li><strong>将想要显示的字段的类型放于列表中</strong>。如 numpy.number 表示数值型的字段； number.object 表示object型的字段。</li>
</ul>
</li>
<li><p><strong>exclude</strong>：与 include 用法相同，作用效果正好相反。</p>
</li>
<li><p><strong>datetime_is_numeric</strong>：<strong>是否将日期时间数据类型视为数字</strong>，默认为False。</p>
</li>
</ul>
<h2 id="数据抽取"><a href="#数据抽取" class="headerlink" title="数据抽取"></a>数据抽取</h2><h5 id="抽取一行考试成绩"><a href="#抽取一行考试成绩" class="headerlink" title="抽取一行考试成绩"></a>抽取一行考试成绩</h5><p>我们可以使用 loc 属性和 iloc 属性抽取一行数据。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">score = [[<span class="number">114</span>, <span class="number">118</span>, <span class="number">109</span>], [<span class="number">98</span>, <span class="number">104</span>, <span class="number">120</span>], [<span class="number">90</span>, <span class="number">117</span>, <span class="number">100</span>], [<span class="number">45</span>, <span class="number">58</span>, <span class="number">95</span>]]  <span class="comment"># 成绩</span></span><br><span class="line">stuname = [<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;angel&#x27;</span>, <span class="string">&#x27;cendy&#x27;</span>]  <span class="comment"># 学生姓名，行索引</span></span><br><span class="line">subject = [<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]  <span class="comment"># 学科，列索引</span></span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  <span class="comment"># 创建DataFrame对象</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 所有数据</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;shiny&#x27;</span>])  <span class="comment"># 抽取一行数据</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>])  <span class="comment"># 抽取一行数据</span></span><br></pre></td></tr></table></figure></div>

<h5 id="抽取任意多行考试成绩"><a href="#抽取任意多行考试成绩" class="headerlink" title="抽取任意多行考试成绩"></a>抽取任意多行考试成绩</h5><p>通过 loc 属性和 iloc 属性指定行名和行索引即可实现抽取任意多行数据。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[[<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;angel&#x27;</span>]])  <span class="comment"># 抽取多行数据</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[[<span class="number">0</span>, <span class="number">2</span>]])  <span class="comment"># 抽取多行数据</span></span><br></pre></td></tr></table></figure></div>

<h5 id="抽取连续多行考试成绩"><a href="#抽取连续多行考试成绩" class="headerlink" title="抽取连续多行考试成绩"></a>抽取连续多行考试成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;shiny&#x27;</span>:<span class="string">&#x27;angel&#x27;</span>])  <span class="comment"># 从&#x27;shiny&#x27;到&#x27;angel’</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[:<span class="string">&#x27;angel&#x27;</span>])  <span class="comment"># 从第1行到&#x27;angel’</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">0</span>:<span class="number">3</span>])  <span class="comment"># 从第1行到第3行</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">1</span>:])  <span class="comment"># 从第2行到最后1</span></span><br></pre></td></tr></table></figure></div>

<h5 id="抽取“数学”和“英语”考试成绩"><a href="#抽取“数学”和“英语”考试成绩" class="headerlink" title="抽取“数学”和“英语”考试成绩"></a>抽取“数学”和“英语”考试成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]])  <span class="comment"># 抽取“数学”和“英语”考试成绩</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[:, [<span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]])  <span class="comment"># 以列名作为参数</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[:, [<span class="number">1</span>, <span class="number">2</span>]])  <span class="comment"># 以列位置索引作为参数</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[:, <span class="string">&#x27;数学&#x27;</span>:])  <span class="comment"># 抽取从“数学”开始到最后一列</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[:, <span class="number">1</span>:<span class="number">3</span>])  <span class="comment"># 连续抽取第2列到第3列的数据</span></span><br></pre></td></tr></table></figure></div>



<h5 id="抽取指定学科和指定学生的考试成绩"><a href="#抽取指定学科和指定学生的考试成绩" class="headerlink" title="抽取指定学科和指定学生的考试成绩"></a>抽取指定学科和指定学生的考试成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">score = [[<span class="number">114</span>, <span class="number">118</span>, <span class="number">109</span>], [<span class="number">98</span>, <span class="number">104</span>, <span class="number">120</span>], [<span class="number">90</span>, <span class="number">117</span>, <span class="number">100</span>], [<span class="number">45</span>, <span class="number">58</span>, <span class="number">95</span>]]  <span class="comment"># 成绩</span></span><br><span class="line">stuname = [<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;angel&#x27;</span>, <span class="string">&#x27;cendy&#x27;</span>]  <span class="comment"># 学生姓名，行索引</span></span><br><span class="line">subject = [<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]  <span class="comment"># 学科，列索引</span></span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  <span class="comment"># 创建DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h5 id="抽取指定学科和指定学生的考试成绩-1"><a href="#抽取指定学科和指定学生的考试成绩-1" class="headerlink" title="抽取指定学科和指定学生的考试成绩"></a>抽取指定学科和指定学生的考试成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>])  <span class="comment"># &#x27;数学&#x27;成绩</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[[<span class="string">&#x27;shiny&#x27;</span>], [<span class="string">&#x27;数学&#x27;</span>]])  <span class="comment"># &#x27;shiny&#x27;的&#x27;数学&#x27;成绩</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[[<span class="string">&#x27;shiny&#x27;</span>], [<span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]])  <span class="comment"># &#x27;shiny&#x27;的&#x27;数学&#x27;和&#x27;英语&#x27;成绩</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[[<span class="number">1</span>], [<span class="number">2</span>]])  <span class="comment"># 第2行第3列</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">1</span>:, [<span class="number">2</span>]])  <span class="comment"># 第2行到最后一行的第3列</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[<span class="number">1</span>:, [<span class="number">0</span>, <span class="number">2</span>]])  <span class="comment"># 第2行到最后一行的第1列和第3列</span></span><br><span class="line"><span class="built_in">print</span>(df.iloc[:, <span class="number">2</span>])  <span class="comment"># 所有行第3列</span></span><br></pre></td></tr></table></figure></div>

<h5 id="获取’shiny’的’数学’成绩"><a href="#获取’shiny’的’数学’成绩" class="headerlink" title="获取’shiny’的’数学’成绩"></a>获取’shiny’的’数学’成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">另外，也可以使用 DataFrame 对象的 iat 属性获取行列数据中的一个元素，该属性以行和列位置索引（即<span class="number">0</span>，<span class="number">1</span>，<span class="number">2</span>，...）作为参数。</span><br><span class="line"><span class="built_in">print</span>(df.iat[<span class="number">0</span>, <span class="number">1</span>])  <span class="comment"># &#x27;shiny&#x27;的&#x27;数学&#x27;成绩，不是一个DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h5 id="抽取指定学科和指定分数的数据"><a href="#抽取指定学科和指定分数的数据" class="headerlink" title="抽取指定学科和指定分数的数据"></a>抽取指定学科和指定分数的数据</h5><p>抽取数学成绩大于等于110分，英语成绩大于等于100分的数据，程序代码如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">result1 = (df[<span class="string">&#x27;数学&#x27;</span>] &gt;= <span class="number">110</span>) &amp; (df[<span class="string">&#x27;英语&#x27;</span>] &gt;= <span class="number">100</span>)  <span class="comment"># &#x27;数学&#x27;大于等于110，&#x27;英语&#x27;大于等于100</span></span><br><span class="line">result2 = (df.iloc[:, <span class="number">1</span>] &gt;= <span class="number">110</span>) &amp; (df.iloc[:, <span class="number">2</span>] &gt;= <span class="number">100</span>)  <span class="comment"># &#x27;数学&#x27;大于等于110，&#x27;英语&#x27;大于等于100</span></span><br><span class="line"><span class="built_in">print</span>(result1)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br><span class="line"><span class="built_in">print</span>(df.loc[result1])  <span class="comment"># 按指定条件抽取数据</span></span><br><span class="line"><span class="built_in">print</span>(df.loc[result2])  <span class="comment"># 按指定条件抽取数据</span></span><br></pre></td></tr></table></figure></div>

<h6 id="抽取指定学科和指定分数的数据-1"><a href="#抽取指定学科和指定分数的数据-1" class="headerlink" title="抽取指定学科和指定分数的数据"></a>抽取指定学科和指定分数的数据</h6><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">result1 = (df[<span class="string">&#x27;数学&#x27;</span>] &gt;= <span class="number">110</span>) &amp; (df[<span class="string">&#x27;英语&#x27;</span>] &gt;= <span class="number">100</span>)</span><br><span class="line">result2 = (df.iloc[:, <span class="number">1</span>] &gt;= <span class="number">110</span>) &amp; (df.iloc[:, <span class="number">2</span>] &gt;= <span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(result1)</span><br><span class="line"><span class="built_in">print</span>(result2)</span><br><span class="line"><span class="built_in">print</span>(df.loc[result1])</span><br><span class="line"><span class="built_in">print</span>(df.loc[result2])</span><br></pre></td></tr></table></figure></div>



<h2 id="数据排序与排名"><a href="#数据排序与排名" class="headerlink" title="数据排序与排名"></a>数据排序与排名</h2><h5 id="按一列数据排序"><a href="#按一列数据排序" class="headerlink" title="按一列数据排序"></a>按一列数据排序</h5><p>按“销售数量”降序排序</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line"></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 设置数据显示的列数和宽度</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.width&#x27;</span>, <span class="number">1000</span>)</span><br><span class="line"><span class="comment"># 导入Excel文件</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;/home/qingjiao/Document/data/10_3/某某医院2020年销售数据.xlsx&#x27;</span>)</span><br><span class="line">df = df.sort_values(by=<span class="string">&#x27;销售数量&#x27;</span>, ascending=<span class="literal">False</span>)  <span class="comment"># 按“销售数量”降序排序</span></span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 输出排序后的DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h5 id="按多列数据排序"><a href="#按多列数据排序" class="headerlink" title="按多列数据排序"></a>按多列数据排序</h5><p>按照“购药时间”和“销售数量”降序排序</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先按照“购药时间”降序排序，然后再按“销售数量”降序排序</span></span><br><span class="line">df = df.sort_values(by=[<span class="string">&#x27;购药时间&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>], ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 输出排序后的DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h5 id="对分组统计数据进行排序"><a href="#对分组统计数据进行排序" class="headerlink" title="对分组统计数据进行排序"></a>对分组统计数据进行排序</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1 = df.groupby([<span class="string">&#x27;商品编码&#x27;</span>])[<span class="string">&#x27;销售数量&#x27;</span>].<span class="built_in">sum</span>().reset_index()  <span class="comment"># 按“商品编码”分组统计“销售数量”</span></span><br><span class="line">df2 = df1.sort_values(by=<span class="string">&#x27;销售数量&#x27;</span>, ascending=<span class="literal">False</span>)  <span class="comment"># 按“销售数量”降序排序</span></span><br><span class="line"><span class="built_in">print</span>(df2)  <span class="comment"># 输出排序后的DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h4 id=""><a href="#" class="headerlink" title=""></a></h4><h5 id="对“销售数量”按顺序进行排名"><a href="#对“销售数量”按顺序进行排名" class="headerlink" title="对“销售数量”按顺序进行排名"></a>对“销售数量”按顺序进行排名</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 设置数据显示的列数和宽度</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="number">500</span>)</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.width&#x27;</span>, <span class="number">1000</span>)</span><br><span class="line"><span class="comment"># 导入Excel文件</span></span><br><span class="line">df = pd.read_excel(<span class="string">&#x27;/home/qingjiao/Document/data/10_3/某某医院2020年销售数据.xlsx&#x27;</span>)</span><br><span class="line">df = df.sort_values(by=<span class="string">&#x27;销售数量&#x27;</span>, ascending=<span class="literal">False</span>)  <span class="comment"># 按“销售数量”降序排序</span></span><br><span class="line">df[<span class="string">&#x27;顺序排名&#x27;</span>] = df[<span class="string">&#x27;销售数量&#x27;</span>].rank(method=<span class="string">&#x27;first&#x27;</span>, ascending=<span class="literal">False</span>)  <span class="comment"># 顺序排名</span></span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;商品名称&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>, <span class="string">&#x27;顺序排名&#x27;</span>]])  <span class="comment"># 输出指定列数据</span></span><br></pre></td></tr></table></figure></div>

<h5 id="对“销售数量”进行平均排名"><a href="#对“销售数量”进行平均排名" class="headerlink" title="对“销售数量”进行平均排名"></a>对“销售数量”进行平均排名</h5><p>现对“销售数量”相同商品，按照顺序排名的平均值进行平均排名，关键代码如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平均排名</span></span><br><span class="line">df[<span class="string">&#x27;平均排名&#x27;</span>] = df[<span class="string">&#x27;销售数量&#x27;</span>].rank(method=<span class="string">&#x27;average&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;商品名称&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>, <span class="string">&#x27;平均排名&#x27;</span>]])  <span class="comment"># 输出指定列数据</span></span><br></pre></td></tr></table></figure></div>

<h5 id="最小值排名"><a href="#最小值排名" class="headerlink" title="最小值排名"></a>最小值排名</h5><p>对“销售数量”按最小值排名</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最小值排名</span></span><br><span class="line">df[<span class="string">&#x27;最小值排名&#x27;</span>] = df[<span class="string">&#x27;销售数量&#x27;</span>].rank(method=<span class="string">&#x27;min&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;商品名称&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>, <span class="string">&#x27;最小值排名&#x27;</span>]])  <span class="comment"># 输出指定列数据</span></span><br></pre></td></tr></table></figure></div>

<h5 id="最大值排名"><a href="#最大值排名" class="headerlink" title="最大值排名"></a>最大值排名</h5><p>对“销售数量”按最大值排名</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最大值排名</span></span><br><span class="line">df[<span class="string">&#x27;最大值排名&#x27;</span>] = df[<span class="string">&#x27;销售数量&#x27;</span>].rank(method=<span class="string">&#x27;max&#x27;</span>, ascending=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(df[[<span class="string">&#x27;商品名称&#x27;</span>, <span class="string">&#x27;销售数量&#x27;</span>, <span class="string">&#x27;最大</span></span><br></pre></td></tr></table></figure></div>



<h2 id="数据计算（一）"><a href="#数据计算（一）" class="headerlink" title="数据计算（一）"></a>数据计算（一）</h2><h5 id="计算每个学生“语文”、“数学”和“英语”三科的总成绩"><a href="#计算每个学生“语文”、“数学”和“英语”三科的总成绩" class="headerlink" title="计算每个学生“语文”、“数学”和“英语”三科的总成绩"></a>计算每个学生“语文”、“数学”和“英语”三科的总成绩</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd  <span class="comment"># 导入pandas模块</span></span><br><span class="line"><span class="comment"># 解决数据输出时列名不对齐的问题</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.unicode.east_asian_width&#x27;</span>, <span class="literal">True</span>)</span><br><span class="line">score = [[<span class="number">114</span>, <span class="number">118</span>, <span class="number">109</span>], [<span class="number">98</span>, <span class="number">104</span>, <span class="number">120</span>], [<span class="number">90</span>, <span class="number">117</span>, <span class="number">100</span>], [<span class="number">45</span>, <span class="number">58</span>, <span class="number">95</span>]]  <span class="comment"># 成绩</span></span><br><span class="line">stuname = [<span class="string">&#x27;shiny&#x27;</span>, <span class="string">&#x27;mark&#x27;</span>, <span class="string">&#x27;angel&#x27;</span>, <span class="string">&#x27;cendy&#x27;</span>]  <span class="comment"># 学生姓名，行索引</span></span><br><span class="line">subject = [<span class="string">&#x27;语文&#x27;</span>, <span class="string">&#x27;数学&#x27;</span>, <span class="string">&#x27;英语&#x27;</span>]  <span class="comment"># 学科，列索引</span></span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  <span class="comment"># 创建DataFrame对象</span></span><br><span class="line">df[<span class="string">&#x27;总成绩&#x27;</span>] = df.<span class="built_in">sum</span>(axis=<span class="number">1</span>)  <span class="comment"># 计算三科的总成绩，并添加&#x27;总成绩&#x27;一列</span></span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 输出DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<h5 id="计算“语文”、“数学”和“英语”各科的平均分"><a href="#计算“语文”、“数学”和“英语”各科的平均分" class="headerlink" title="计算“语文”、“数学”和“英语”各科的平均分"></a>计算“语文”、“数学”和“英语”各科的平均分</h5><p>计算“语文”、“数学”和“英语”各科成绩的平均值，忽略索引。关键代码如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">score_mean = df.mean()  <span class="comment"># 求各科的平均分，默认按列求平均值</span></span><br><span class="line"><span class="comment"># 追加一行数据（各科的平均分），忽略索引</span></span><br><span class="line">df = df.append(score_mean, ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df)  <span class="comment"># 输出DataFrame对象</span></span><br></pre></td></tr></table></figure></div>

<p>计算“语文”、“数学”和“英语”各科成绩的平均值，不忽略索引。关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">score_mean = df.mean()  # 求各科的平均分，默认按列求平均值</span><br><span class="line"># 创建一个Series对象，使用name参数为Series命名，此示例中作为新增行的行索引</span><br><span class="line">series = pd.Series(score_mean, name=&#x27;平均成绩&#x27;)</span><br><span class="line"># 追加一行数据（各科的平均分），不忽略索引</span><br><span class="line">df = df.append(series, ignore_index=False)</span><br><span class="line">print(df)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="计算“语文”、“数学”和“英语”各科的最高分"><a href="#计算“语文”、“数学”和“英语”各科的最高分" class="headerlink" title="计算“语文”、“数学”和“英语”各科的最高分"></a>计算“语文”、“数学”和“英语”各科的最高分</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">score_max = df.max()  # 求各科的最高分，默认按列求最大值</span><br><span class="line"># 创建一个Series对象，使用name参数为Series命名，此示例中作为新增行的行索引</span><br><span class="line">series = pd.Series(score_max, name=&#x27;最高分&#x27;)</span><br><span class="line"># 追加一行数据（各科的最高分），不忽略索引</span><br><span class="line">df = df.append(series, ignore_index=False)</span><br><span class="line">print(df)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="计算“语文”、“数学”和“英语”各科的最低分"><a href="#计算“语文”、“数学”和“英语”各科的最低分" class="headerlink" title="计算“语文”、“数学”和“英语”各科的最低分"></a>计算“语文”、“数学”和“英语”各科的最低分</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">score_min= df.min()  # 求各科的最低分，默认按列求最小值</span><br><span class="line"># 创建一个Series对象，使用name参数为Series命名，此示例中作为新增行的行索引</span><br><span class="line">series = pd.Series(score_min, name=&#x27;最低分&#x27;)</span><br><span class="line"># 追加一行数据（各科的最低分），不忽略索引</span><br><span class="line">df = df.append(series, ignore_index=False)</span><br><span class="line">print(df)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>



<h2 id="数据计算（二）"><a href="#数据计算（二）" class="headerlink" title="数据计算（二）"></a>数据计算（二）</h2><h5 id="计算学生各科成绩的中位数"><a href="#计算学生各科成绩的中位数" class="headerlink" title="计算学生各科成绩的中位数"></a>计算学生各科成绩的中位数</h5><p>使用 median 函数计算“语文”、“数学”和“英语”各科成绩的中位数，程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">score = [[114, 118, 109], [98, 104, 120], [90, 117, 100], [45, 58, 95]]  # 成绩</span><br><span class="line">stuname = [&#x27;shiny&#x27;, &#x27;mark&#x27;, &#x27;angel&#x27;, &#x27;cendy&#x27;]  # 学生姓名，行索引</span><br><span class="line">subject = [&#x27;语文&#x27;, &#x27;数学&#x27;, &#x27;英语&#x27;]  # 学科，列索引</span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  # 创建DataFrame对象</span><br><span class="line">print(df.median())  # 计算学生各科成绩的中位数</span><br></pre></td></tr></table></figure></div>

<h5 id="计算学生各科成绩的众数"><a href="#计算学生各科成绩的众数" class="headerlink" title="计算学生各科成绩的众数"></a>计算学生各科成绩的众数</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">score = [[114, 114, 109], [90, 117, 90], [100, 117, 100], [90, 90, 100]]  # 成绩</span><br><span class="line">stuname = [&#x27;shiny&#x27;, &#x27;mark&#x27;, &#x27;angel&#x27;, &#x27;cendy&#x27;]  # 学生姓名，行索引</span><br><span class="line">subject = [&#x27;语文&#x27;, &#x27;数学&#x27;, &#x27;英语&#x27;]  # 学科，列索引</span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  # 创建DataFrame对象</span><br><span class="line">print(df.mode())  # 各科成绩的众数</span><br><span class="line">print(df.mode(axis=1))  # 每个学生成绩的众数</span><br><span class="line">print(df[&#x27;数学&#x27;].mode())  # “数学”的众数</span><br></pre></td></tr></table></figure></div>

<h5 id="通过方差判断谁的物理成绩更稳定"><a href="#通过方差判断谁的物理成绩更稳定" class="headerlink" title="通过方差判断谁的物理成绩更稳定"></a>通过方差判断谁的物理成绩更稳定</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">score = [[110, 113, 102, 105, 108], [118, 98, 119, 85, 118]]  # 物理成绩</span><br><span class="line">stuname = [&#x27;shiny&#x27;, &#x27;mark&#x27;]  # 学生姓名，行索引</span><br><span class="line">subject = [&#x27;物理1&#x27;, &#x27;物理2&#x27;, &#x27;物理3&#x27;, &#x27;物理4&#x27;, &#x27;物理5&#x27;]  # 学科，列索引</span><br><span class="line">df = pd.DataFrame(data=score, index=stuname, columns=subject)  # 创建DataFrame对象</span><br><span class="line">print(df.var(axis=1))  # 每个学生物理成绩的方差</span><br></pre></td></tr></table></figure></div>

<h5 id="计算两名学生物理成绩的标准差"><a href="#计算两名学生物理成绩的标准差" class="headerlink" title="计算两名学生物理成绩的标准差"></a>计算两名学生物理成绩的标准差</h5><p>使用 std 函数计算 shiny 和 mark 物理成绩标准差。关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(df.std(axis=1))  # 每个学生物理成</span><br></pre></td></tr></table></figure></div>



<h2 id="数据格式化"><a href="#数据格式化" class="headerlink" title="数据格式化"></a>数据格式化</h2><h5 id="四舍五入保留指定的小数位数"><a href="#四舍五入保留指定的小数位数" class="headerlink" title="四舍五入保留指定的小数位数"></a>四舍五入保留指定的小数位数</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">import numpy as np  # 导入numpy模块</span><br><span class="line">n = np.random.random([5, 5])  # 用于生成[0.0,1.0)之间的随机浮点数5行5列二维数组</span><br><span class="line">num = [&#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;, &#x27;A4&#x27;, &#x27;A5&#x27;]  # 列索引</span><br><span class="line">df = pd.DataFrame(data=n, columns=num)  # 创建DataFrame对象</span><br><span class="line">print(df)  # 输出DataFrame对象</span><br><span class="line">print(df.round(2))  # 保留小数点后两位</span><br><span class="line">print(df.round(&#123;&#x27;A1&#x27;: 1, &#x27;A2&#x27;: 2&#125;))  # A1列保留小数点后一位，A2列保留小数点后两位</span><br><span class="line">s1 = pd.Series([1, 0, 2], index=[&#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;])  # 创建Series对象，设置行索引</span><br><span class="line">print(df.round(s1))  # 设置Series对象的小数位数</span><br></pre></td></tr></table></figure></div>

<h5 id="四舍五入保留指定的小数位数-1"><a href="#四舍五入保留指定的小数位数-1" class="headerlink" title="四舍五入保留指定的小数位数"></a>四舍五入保留指定的小数位数</h5><p>运行程序，输出结果为：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(df)  # 输出DataFrame对象</span><br><span class="line">print(df.round(2))  # 保留小数点后两位</span><br><span class="line">print(df.round(&#123;&#x27;A1&#x27;: 1, &#x27;A2&#x27;: 2&#125;))  # A1列保留小数点后一位，A2列保留小数点后两位</span><br><span class="line">s1 = pd.Series([1, 0, 2], index=[&#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;])  # 创建Series对象，设置行索引</span><br><span class="line">print(df.round(s1))  # 设置Series对象的小数位数</span><br></pre></td></tr></table></figure></div>

<h5 id="将指定数据格式化为百分比数据"><a href="#将指定数据格式化为百分比数据" class="headerlink" title="将指定数据格式化为百分比数据"></a>将指定数据格式化为百分比数据</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">import numpy as np  # 导入numpy模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题</span><br><span class="line">pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)n = np.random.random([5, 5])  # 用于生成[0.0,0.1)之间的随机浮点数5行5列二维数组</span><br><span class="line">num = [&#x27;A1&#x27;, &#x27;A2&#x27;, &#x27;A3&#x27;, &#x27;A4&#x27;, &#x27;A5&#x27;]  # 列索引</span><br><span class="line">df = pd.DataFrame(data=n, columns=num)  # 创建DataFrame对象</span><br><span class="line">df[&#x27;百分比1&#x27;] = df[&#x27;A5&#x27;].apply(lambda x: format(x, &#x27;.0%&#x27;))  # A5列保留0位小数</span><br><span class="line">df[&#x27;百分比2&#x27;] = df[&#x27;A5&#x27;].apply(lambda x: format(x, &#x27;.2%&#x27;))  # A5列保留2位小数</span><br><span class="line">df[&#x27;百分比3&#x27;] = df[&#x27;A5&#x27;].map(lambda x: &#x27;&#123;:.2%&#125;&#x27;.format(x))  # A5列保留2位小数</span><br><span class="line">print(df)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>



<h2 id="数据分组统计（一）"><a href="#数据分组统计（一）" class="headerlink" title="数据分组统计（一）"></a>数据分组统计（一）</h2><h5 id="根据“一级分类”统计订单数据"><a href="#根据“一级分类”统计订单数据" class="headerlink" title="根据“一级分类”统计订单数据"></a>根据“一级分类”统计订单数据</h5><p>按照图书“一级分类”对订单数据进行分组统计求和。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)</span><br><span class="line"># 导入Excel文件</span><br><span class="line">df = pd.read_excel(&#x27;/home/qingjiao/Document/data/12_4/books.xlsx&#x27;)</span><br><span class="line">df1 = df[[&#x27;一级分类&#x27;, &#x27;点击量&#x27;, &#x27;订单预定&#x27;]]  # 抽取指定列的数据</span><br><span class="line">df2 = df1.groupby(&#x27;一级分类&#x27;).sum()  # 分组统计求和</span><br><span class="line">print(df2)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="统计各编程语言的总订单预定数"><a href="#统计各编程语言的总订单预定数" class="headerlink" title="统计各编程语言的总订单预定数"></a>统计各编程语言的总订单预定数</h5><p>统计各编程语言的总订单预定数，首先按“二级分类”分组，然后抽取“订单预定”列并对该列进行求和运算，关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 首先按“二级分类”分组，然后抽取“订单预定”列并对该列进行求和运算</span><br><span class="line">df1 = df.groupby(&#x27;二级分类&#x27;)[&#x27;订单预定&#x27;].sum()</span><br><span class="line">print(df1)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="迭代“一级分类”的订单数据"><a href="#迭代“一级分类”的订单数据" class="headerlink" title="迭代“一级分类”的订单数据"></a>迭代“一级分类”的订单数据</h5><p>按照“一级分类”分组，并输出每一分类中的订单数据。关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for name, group in df.groupby(&#x27;一级分类&#x27;):  # 按照“一级分类”分组</span><br><span class="line">    print(name)  # 输出分类</span><br><span class="line">    print(group)  # 输出每一分类中的订单数据</span><br></pre></td></tr></table></figure></div>

<h5 id="迭代两级分类的订单数据"><a href="#迭代两级分类的订单数据" class="headerlink" title="迭代两级分类的订单数据"></a>迭代两级分类的订单数据</h5><p>迭代“一级分类”和“二级分类”的订单数据。关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 按照“一级分类”和“二级分类”分组</span><br><span class="line">for (key1, key2), group in df.groupby([&#x27;一级分类&#x27;, &#x27;二级分类&#x27;]):</span><br><span class="line">    print(key1, key2)  # 输出分类</span><br><span class="line">    print(group)  # 输出分类中的订单数据</span><br></pre></td></tr></table></figure></div>

<h5 id="迭代两级分类的订单数据-1"><a href="#迭代两级分类的订单数据-1" class="headerlink" title="迭代两级分类的订单数据"></a>迭代两级分类的订单数据</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 按照“一级分类”和“二级分类”分组</span><br><span class="line">for (key1, key2), group in df.groupby([&#x27;一级分类&#x27;, &#x27;二级分类&#x27;]):</span><br><span class="line">    print(key1, key2)  # 输出分类</span><br><span class="line">    print(group)  # 输出分类中的订单数据</span><br></pre></td></tr></table></figure></div>



<h4 id="数据分组统计（二）"><a href="#数据分组统计（二）" class="headerlink" title="数据分组统计（二）"></a>数据分组统计（二）</h4><h5 id="对分组统计结果使用聚合函数"><a href="#对分组统计结果使用聚合函数" class="headerlink" title="对分组统计结果使用聚合函数"></a>对分组统计结果使用聚合函数</h5><p>按照图书“一级分类”分组统计“点击量”和“订单预定”的平均值和总和。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题</span><br><span class="line">pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)</span><br><span class="line"># 导入Excel文件</span><br><span class="line">df = pd.read_excel(&#x27;/home/qingjiao/Document/data/12_4/books.xlsx&#x27;)</span><br><span class="line">df1 = df[[&#x27;一级分类&#x27;, &#x27;点击量&#x27;, &#x27;订单预定&#x27;]]  # 抽取指定列的数据</span><br><span class="line">df2 = df1.groupby(&#x27;一级分类&#x27;).agg([&#x27;mean&#x27;, &#x27;sum&#x27;])  # 对分组统计结果求平均值、求和</span><br><span class="line">print(df2)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="通过字典分组统计“北上广”的销量"><a href="#通过字典分组统计“北上广”的销量" class="headerlink" title="通过字典分组统计“北上广”的销量"></a>通过字典分组统计“北上广”的销量</h5><p>统计各地区的销量，业务要求：将“北京”、“上海”和“广州”三个一线城市放在一起进行统计。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题</span><br><span class="line">pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)</span><br><span class="line"># 导入Excel文件</span><br><span class="line">df = pd.read_excel(&#x27;/home/qingjiao/Document/data/12_5/python_books.xlsx&#x27;)</span><br><span class="line">df = df.set_index(&#x27;商品名称&#x27;)  # 将DataFrame中的列转化为行索引</span><br><span class="line">dict1 = &#123;&#x27;北京出库销量&#x27;: &#x27;北上广&#x27;, &#x27;上海出库销量&#x27;: &#x27;北上广&#x27;,</span><br><span class="line">        &#x27;广州出库销量&#x27;: &#x27;北上广&#x27;, &#x27;天津出库销量&#x27;: &#x27;天津&#x27;&#125;  # 定义字典</span><br><span class="line">df1 = df.groupby(dict1, axis=1).sum()  # 统计各地区销量</span><br><span class="line">print(df1)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>

<h5 id="通过-Series-对象分组统计“北上广”销量"><a href="#通过-Series-对象分组统计“北上广”销量" class="headerlink" title="通过 Series 对象分组统计“北上广”销量"></a>通过 Series 对象分组统计“北上广”销量</h5><p>首先，创建一个 Series 对象。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题</span><br><span class="line">pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)</span><br><span class="line"># 导入Excel文件</span><br><span class="line">df = pd.read_excel(&#x27;/home/qingjiao/Document/data/12_5/python_books.xlsx&#x27;)</span><br><span class="line">data = &#123;&#x27;北京出库销量&#x27;: &#x27;北上广&#x27;, &#x27;上海出库销量&#x27;: &#x27;北上广&#x27;,</span><br><span class="line">        &#x27;广州出库销量&#x27;: &#x27;北上广&#x27;, &#x27;天津出库销量&#x27;: &#x27;天津&#x27;&#125;  # 定义字典</span><br><span class="line">s1 = pd.Series(data)  # 创建Series对象</span><br><span class="line">print(s1)  # 输出Series对象</span><br></pre></td></tr></table></figure></div>

<h5 id="通过-Series-对象分组统计“北上广”销量-1"><a href="#通过-Series-对象分组统计“北上广”销量-1" class="headerlink" title="通过 Series 对象分组统计“北上广”销量"></a>通过 Series 对象分组统计“北上广”销量</h5><p>然后，将 Series 对象传递给 groupby 函数实现数据分组统计，关键代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = df.set_index(&#x27;商品名称&#x27;)  # 将DataFrame中的列转化为行索引</span><br><span class="line">df1 = df.groupby(s1, axis=1).sum()  # 统计各地区销量</span><br><span class="line">print(df1)  # 输出DataFrame对象</span><br></pre></td></tr></table></figure></div>



<h2 id="常用图表的绘制"><a href="#常用图表的绘制" class="headerlink" title="常用图表的绘制"></a>常用图表的绘制</h2><p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191537526.png"
                      alt="image-20240519153722897"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191537798.png"
                      alt="image-20240519153741722"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191538529.png"
                      alt="image-20240519153812495"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191539872.png"
                      alt="image-20240519153948973"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191541468.png"
                     
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191542519.png"
                      alt="image-20240519154204519"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191542400.png"
                      alt="image-20240519154235575"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191543253.png"
                      alt="image-20240519154308176"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191544588.png"
                      alt="image-20240519154411595"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191544142.png"
                      alt="image-20240519154448466"
                >、</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191545281.png"
                      alt="image-20240519154504088"
                ></p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://qwe-pic1.oss-cn-beijing.aliyuncs.com/images/202405191546212.png"
                      alt="image-20240519154559188"
                ></p>
<h2 id="数据统计分析案例"><a href="#数据统计分析案例" class="headerlink" title="数据统计分析案例"></a>数据统计分析案例</h2><h5 id="数据检测"><a href="#数据检测" class="headerlink" title="数据检测"></a>数据检测</h5><p>查看 &#x2F;home&#x2F;qingjiao&#x2F;Document&#x2F;data&#x2F;17_1&#x2F;user.xlsx 数据的缺失值情况，并统计每列的缺失值。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"></span><br><span class="line"># 导入Excel数据文件data = pd.read_excel(&#x27;/home/qingjiao/Document/data/17_1/user.xlsx’)</span><br><span class="line"></span><br><span class="line">print(data.info())  # 查看缺失值</span><br><span class="line">print(data.isnull().sum())  # 统计每列的缺失值情况</span><br></pre></td></tr></table></figure></div>

<h5 id="按月统计和显示数据"><a href="#按月统计和显示数据" class="headerlink" title="按月统计和显示数据"></a>按月统计和显示数据</h5><p>按月统计每一年的注册用户增长情况，并进行分析。具体步骤如下：<br>（1）通过 read_excel 函数导入 &#x2F;home&#x2F;qingjiao&#x2F;Document&#x2F;data&#x2F;17_1&#x2F;user.xlsx 数据文件，使用 to_datetime 函数将字符型的日期格式的数据转换成为日期型数据，之后使用 resample 函数和 to_period 函数按月统计和显示数据，前提是日期必须设置为索引。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 导入Excel数据文件</span><br><span class="line">data = pd.read_excel(&#x27;/home/qingjiao/Document/data/17_1/user.xlsx&#x27;)</span><br><span class="line">data[&#x27;注册日期&#x27;] = pd.to_datetime(data[&#x27;注册日期&#x27;])  # 将数据类型转换为日期类型</span><br><span class="line">data = data.set_index(&#x27;注册日期&#x27;)  # 将&#x27;注册日期&#x27;设置为索引</span><br><span class="line">df_month = data.resample(&#x27;M&#x27;).size().to_period(&#x27;M&#x27;)  # 按月统计并显示数据</span><br><span class="line">print(df_month)  # 输出按月统计的每一年的注册用户结果</span><br></pre></td></tr></table></figure></div>

<h5 id="获取日期区间的数据"><a href="#获取日期区间的数据" class="headerlink" title="获取日期区间的数据"></a>获取日期区间的数据</h5><p>（2）统计完成后直接在 DataFrame 对象中输入日期获取日期区间的数据；自定义行索引，使用 index 属性重新设置 DataFrame 对象的行索引；使用 concat 函数实现横向表合并，即将 3 年的数据合并在一起，可以利用 columns 属性重新设置列索引；最后使用 to_excel 函数将数据导出为 Excel 文件。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 自定义行索引</span><br><span class="line">index = [&#x27;1月&#x27;, &#x27;2月&#x27;, &#x27;3月&#x27;, &#x27;4月&#x27;, &#x27;5月&#x27;, &#x27;6月&#x27;, &#x27;7月&#x27;, &#x27;8月&#x27;, &#x27;9月&#x27;, &#x27;10月&#x27;, &#x27;11月&#x27;, &#x27;12月&#x27;]</span><br><span class="line">df_2018_month = df_month[&#x27;2018&#x27;]  # 获取&#x27;2018&#x27;年的数据</span><br><span class="line">df_2018_month.index = index  # 设置索引</span><br><span class="line">df_2019_month = df_month[&#x27;2019&#x27;]  # 获取&#x27;2019&#x27;年的数据</span><br><span class="line">df_2019_month.index = index  # 设置索引</span><br><span class="line">df_2020_month = df_month[&#x27;2020&#x27;]  # 获取&#x27;2020&#x27;年的数据</span><br><span class="line">df_2020_month.index = index  # 设置索引</span><br><span class="line">data_year = pd.concat([df_2018_month, df_2019_month, df_2020_month], axis=1)  # 按行对齐，合并3年的数据</span><br><span class="line">data_year.columns = [&#x27;2018年&#x27;, &#x27;2019年&#x27;, &#x27;2020年&#x27;]  # 设置列索引</span><br><span class="line">data_year.to_excel(&#x27;/home/qingjiao/Document/data/17_1/data_year.xlsx&#x27;)  # 导出数据为Excel文件</span><br><span class="line">print(data_year)  # 输出数据</span><br></pre></td></tr></table></figure></div>

<h5 id="按月统计每一年的注册用户增长情况完整代码"><a href="#按月统计每一年的注册用户增长情况完整代码" class="headerlink" title="按月统计每一年的注册用户增长情况完整代码"></a>按月统计每一年的注册用户增长情况完整代码</h5><div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line"># 解决数据输出时列名不对齐的问题</span><br><span class="line">pd.set_option(&#x27;display.unicode.east_asian_width&#x27;, True)</span><br><span class="line">data = pd.read_excel(&#x27;/home/qingjiao/Document/data/17_1/user.xlsx&#x27;)  # 导入Excel数据文件</span><br><span class="line">data[&#x27;注册日期&#x27;] = pd.to_datetime(data[&#x27;注册日期&#x27;])  # 将数据类型转换为日期类型</span><br><span class="line">data = data.set_index(&#x27;注册日期&#x27;)  # 将&#x27;注册日期&#x27;设置为索引</span><br><span class="line"># 按月统计每一年的注册用户</span><br><span class="line">df_month = data.resample(&#x27;M&#x27;).size().to_period(&#x27;M&#x27;)  # 按月统计并显示数据</span><br><span class="line"># 自定义行索引</span><br><span class="line">index = [&#x27;1月&#x27;, &#x27;2月&#x27;, &#x27;3月&#x27;, &#x27;4月&#x27;, &#x27;5月&#x27;, &#x27;6月&#x27;, &#x27;7月&#x27;, &#x27;8月&#x27;, &#x27;9月&#x27;, &#x27;10月&#x27;, &#x27;11月&#x27;, &#x27;12月&#x27;]</span><br><span class="line">df_2018_month = df_month[&#x27;2018&#x27;]  # 获取&#x27;2018&#x27;年的数据</span><br><span class="line">df_2018    _month.index = index  # 设置索引</span><br><span class="line">df_2019_month = df_month[&#x27;2019&#x27;]  # 获取&#x27;2019&#x27;年的数据</span><br><span class="line">df_2019_month.index = index  # 设置索引</span><br><span class="line">df_2020_month = df_month[&#x27;2020&#x27;]  # 获取&#x27;2020&#x27;年的数据</span><br><span class="line">df_2020_month.index = index  # 设置索引</span><br><span class="line">data_year = pd.concat([df_2018_month, df_2019_month, df_2020_month], axis=1)  # 按行对齐，合并3年的数据</span><br><span class="line">data_year.columns = [&#x27;2018年&#x27;, &#x27;2019年&#x27;, &#x27;2020年&#x27;]  # 设置列索引</span><br><span class="line">data_year.to_excel(&#x27;/home/qingjiao/Document/data/17_1/data_year.xlsx&#x27;)  # 导出数据为Excel文件</span><br><span class="line">print(data_year)  # 输出数据</span><br></pre></td></tr></table></figure></div>

<h5 id="绘制多折线图"><a href="#绘制多折线图" class="headerlink" title="绘制多折线图"></a>绘制多折线图</h5><p>（3）使用 plot 函数将 data_year.xlsx 文件中的数据绘制成多折线图，比较每一年的注册用户增长情况。程序代码如下：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd  # 导入pandas模块</span><br><span class="line">import matplotlib.pyplot as plt  # 导入matplotlib中的pyplot模块</span><br><span class="line"></span><br><span class="line"># 导入Excel文件</span><br><span class="line">df = pd.read_excel(&#x27;/home/qingjiao/Document/data/17_1/data_year.xlsx&#x27;)</span><br><span class="line"></span><br><span class="line"># 手动添加黑体字体，解决中文乱码问题</span><br><span class="line">plt.rcParams[&#x27;font.sans-serif&#x27;] = [&#x27;SimHei&#x27;]</span><br><span class="line"></span><br><span class="line"># 创建绘图对象，设置画布的宽度和高度</span><br><span class="line">plt.figure(figsize=(8, 6))</span><br><span class="line"></span><br><span class="line"># 绘制多折线图</span><br><span class="line">x = df[&#x27;Unnamed: 0&#x27;]  # x轴数据</span><br><span class="line">y1, y2, y3 = df[&#x27;2018年&#x27;], df[&#x27;2019年&#x27;], df[&#x27;2020年&#x27;]  # y轴数据</span><br><span class="line"></span><br><span class="line"># 绘制2018年注册会员折线图，红色，星形标记，标记大小为9</span><br><span class="line">plt.plot(x, y1, label=&#x27;2018年&#x27;, color=&#x27;r&#x27;, marker=&#x27;*&#x27;, ms=9)</span><br><span class="line"></span><br><span class="line"># 绘制2019年注册会员折线图，绿色，实心圆标记</span><br><span class="line">plt.plot(x, y2, label=&#x27;2019年&#x27;, color=&#x27;g&#x27;, marker=&#x27;o&#x27;)</span><br><span class="line"></span><br><span class="line"># 绘制2020年注册会员折线图，蓝色，上三角标记，标记为红色，大小为8</span><br><span class="line">plt.plot(x, y3, label=&#x27;2020年&#x27;, color=&#x27;b&#x27;, marker=&#x27;^&#x27;, mfc=&#x27;r&#x27;, ms=8)</span><br><span class="line">plt.title(&#x27;年度注册会员分析&#x27;, fontsize=18)  # 设置图表标题，字体大小为18</span><br><span class="line">plt.xlabel(&#x27;注册日期&#x27;)  # x轴标题</span><br><span class="line">plt.ylabel(&#x27;用户数量&#x27;)  # y轴标题</span><br><span class="line">plt.ylim(0, 12000)  # 设置y轴范围为0~12000</span><br><span class="line">plt.grid(axis=&#x27;y&#x27;, color=&#x27;0.5&#x27;, linestyle=&#x27;--&#x27;)  # 隐藏y轴网格线，灰度值为0.5，双划线</span><br><span class="line">plt.legend([&#x27;2018年&#x27;, &#x27;2019年&#x27;, &#x27;2020年&#x27;])  # 设置图表图例</span><br><span class="line"></span><br><span class="line"># 设置文本标签</span><br><span class="line">for a, b1, b2, b3 in zip(x, y1, y2, y3):</span><br><span class="line">    plt.text(a, b1 + 100, b1, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;, fontsize=10, color=&#x27;r&#x27;)</span><br><span class="line">    plt.text(a, b2 + 100, b2, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;, fontsize=10, color=&#x27;g&#x27;)</span><br><span class="line">    plt.text(a, b3 + 200, b3, ha=&#x27;center&#x27;, va=&#x27;bottom&#x27;, fontsize=10, color=&#x27;b&#x27;)</span><br><span class="line">plt.savefig(&#x27;/home/qingjiao/Desktop/users.png&#x27;)  # 保存图表</span><br><span class="line">plt.show()  # 显示图表</span><br></pre></td></tr></table></figure></div>
        </div>

        
            <div class="post-copyright-info">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> python数据分析</li>
        <li><strong>作者:</strong> 小禹君</li>
        <li><strong>创建于
                :</strong> 2024-04-29 22:38:19</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-05-27 18:02:02
            </li>
        
        <li>
            <strong>链接:</strong> https://redefine.ohevan.com/2024/04/29/数据分析/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            
            本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 进行许可。
            

        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">#数据分析</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                        rel="prev"
                        href="/2024/05/05/Untitled%202/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item"></span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                        rel="next"
                        href="/2024/04/18/c++%E8%AF%AD%E6%B3%95/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">c++语法</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container">
                <div class="comments-container pjax">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        <i class="fa-solid fa-comments"></i>&nbsp;评论
    </div>
    

        
            
 
    <div id="waline"></div>
    <script type="module"  data-swup-reload-script>
        import { init } from '/js/libs/waline.mjs';

        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://example.example.com',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
            });
        }

        if ('true') {
            const loadWalineTimeout = setTimeout(() => {
                loadWaline();
                clearTimeout(loadWalineTimeout);
            }, 1000);
        } else {
            window.addEventListener('DOMContentLoaded', loadWaline);
        }
        
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">python数据分析</div>
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pandans"><span class="nav-text">pandans</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5excel%E6%96%87%E4%BB%B6"><span class="nav-text">导入excel文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E4%B8%BA-Excel-%E6%96%87%E4%BB%B6"><span class="nav-text">将数据导出为 Excel 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5csv%E6%96%87%E4%BB%B6"><span class="nav-text">导入csv文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%86%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%87%BA%E4%B8%BA-csv-%E6%96%87%E4%BB%B6"><span class="nav-text">将数据导出为 csv 文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%BC%E5%85%A5-txt-%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6"><span class="nav-text">导入 txt 文本文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="nav-text">数据清洗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%BD%E5%8F%96"><span class="nav-text">数据抽取</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%8E%92%E5%BA%8F%E4%B8%8E%E6%8E%92%E5%90%8D"><span class="nav-text">数据排序与排名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%EF%BC%88%E4%B8%80%EF%BC%89"><span class="nav-text">数据计算（一）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%AE%A1%E7%AE%97%EF%BC%88%E4%BA%8C%EF%BC%89"><span class="nav-text">数据计算（二）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-text">数据格式化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84%E7%BB%9F%E8%AE%A1%EF%BC%88%E4%B8%80%EF%BC%89"><span class="nav-text">数据分组统计（一）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E5%9B%BE%E8%A1%A8%E7%9A%84%E7%BB%98%E5%88%B6"><span class="nav-text">常用图表的绘制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90%E6%A1%88%E4%BE%8B"><span class="nav-text">数据统计分析案例</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2026&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">小禹君</a>
        </div>
        
            <script data-swup-reload-script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.5.0</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/libs/anime.min.js"></script>

        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


    <div id="aplayer"></div>

<script src="/js/libs/APlayer.min.js"></script>


<script src="/js/plugins/aplayer.js"></script>


<script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>